{% extends 'base.html' %}

{% load comparison %}

{% block head_extras %}
{% for model, result_list in results %}
<script type="text/javascript">
$(document).ready(function()
{
  $("#{{ model_verbose_plural }}.header").click(function()
  {
    $(this).next("#{{ model.verbose_plural }}").slideToggle(600);
  });
});
</script>
{% endfor %}
<style>
h3.selected a {
    color: #333333;
}
h3.selected a:hover {
    color: #999999;
}
</style>
{% endblock head_extras %}

{% block content %}
    <form method="get" action=".">
        <table>
            {{ form.as_table }}
            <tr>
                <td>&nbsp;</td>
                <td>
                    <input type="submit" value="Search">
                </td>
            </tr>
        </table>
        {% if spelling_suggestion %}<h3>Did you mean <a href="?q={{ literal_spelling_suggestion }}">{{ spelling_suggestion|capfirst }}</a>?</h3>{% endif %}
        {% if query %}
            <h2>Results</h2>
            <div class="object_list">
            {% for model, result_list in results %}
                <h2 id="{{ model.verbose_plural }}" class="header">{{ model.verbose_plural|capfirst }}<div class="calendar_link">Showing 1 &ndash; {% if_less model.count model.limit %}{{ model.count }}{% else %}{{ model.limit }}{% endif_less %} of {{ model.count }}</div></h2>
                {% if result_list %}
                <ul id="{{ model.verbose_plural }}">
                {% for result in result_list %}
                    {% if_less_or_equal model.count model.limit %}
                    <li class="search_result item">
                        {{ result.rendered|safe }}
                    </li>
                    {% else %}
                        {% if_less_or_equal forloop.counter model.limit %}
                            <li class="search_result item">
                                {{ result.rendered|safe }}
                            </li>
                        {% endif_less_or_equal %}
                    {% endif_less_or_equal %}
                {% endfor %}
                </ul>
                <div style="clear:both;"></div>
                <p class="fp_section_refer"><a href="/newsearch/{{ model.model_name }}/?q={{ literal_query }}">See more {{ model.verbose_plural }} &raquo;</a></p>
                {% else %}
                    <h2>No {{ model.verbose_plural }} matched your search.</h2>
                {% endif %}
            {% empty %}
                <p>No results found.</p>
            {% endfor %}
            </div>
        {% else %}
            {# Show some example queries to run, maybe query syntax, something else? #}
        {% endif %}
        
    </form>
{% endblock content %}

{% block sidebar %}
    <h2 class="sectiongrey">Sort results</h2>
    <h3{% ifequal order_by 'date' %} class="selected"{% endifequal %}><a href="?q={{ literal_query }}{% for model in model_list %}&models={{ model }}{% endfor %}&order=date">Date</a></h3>
    <h3{% ifnotequal order_by 'date' %} class="selected"{% endifnotequal %}><a href="?q={{ literal_query }}{% for model in model_list %}&models={{ model }}{% endfor %}&order=relevance">Relevance</a></h3>
{% endblock sidebar %}
